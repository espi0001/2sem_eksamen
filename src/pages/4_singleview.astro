---
import MainLayout from "../layouts/MainLayout.astro";
import Breadcrumb2 from "../components/Breadcrumb2.astro";
import Singleview from "../components/Singleview.astro";

const apiUrl = "https://orihtpvviiwcpmwzboqr.supabase.co/rest/v1/ekamen";
const apiKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9yaWh0cHZ2aWl3Y3Btd3pib3FyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTYzNjY0NzEsImV4cCI6MjAzMTk0MjQ3MX0.D3VmybLu_cJTAhpmkfHnKtssujUzP4qg3XDV1owo6Cw";

let productDetails = null;

// Fetch product details based on the product ID
async function fetchProductDetails(productId) {
  try {
    const response = await fetch(`${apiUrl}/${productId}`, {
      headers: {
        apikey: apiKey,
      },
    });

    if (!response.ok) {
      throw new Error("Failed to fetch product details");
    }

    return await response.json();
  } catch (error) {
    console.error("Error fetching product details:", error);
    return null;
  }
}

// Run this function when the component mounts, but only on the client-side
if (typeof window !== "undefined") {
  const urlParams = new URLSearchParams(window.location.search);
  const productId = urlParams.get("id");
  fetchProductDetails(productId).then((data) => {
    productDetails = data;
  });
}
---

<MainLayout title="Produkt">
  <section>
    <Breadcrumb2 navn1="Merchandise" navn2="TÃ¸j" navn3={productDetails?.name || ""} />
    <Singleview productDetails={productDetails} />
  </section>
</MainLayout>

<style>
  /* ___________________________ TABLET  ___________________________*/
  @media screen and (min-width: 768px) {
    section {
    }
  }

  /* ___________________________ DESKTOP  ___________________________*/
  @media screen and (min-width: 1024px) {
  }
</style>
